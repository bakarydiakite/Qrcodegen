{% load static %}

<!DOCTYPE html>
<html>

<head>
  <title>Historique des Images</title>
  <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">
  <style>
    body {
      background-color: rgba(255, 251, 249, 0.995);
    }

    .image-card {
      display: flex;
      align-items: center;
      width: 300px;
      margin-bottom: 20px;
    }

    .image-card img {
      width: 100%;
      height: auto;
    }

    .image-card .card-footer {
      background-color: #f8f9fa;
      text-align: center;
      font-size: 14px;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>Historique des Images</h1>
    <a href="{% url 'home' %}" class="btn btn-primary w-25 mb-4">Acceuil</a>
    <div class="row">

      {% for img in images %}

      <div class="col-lg-4 col-md-6 mb-4">
        <div class="card image-card" style="width: 100%;">
          <!-- Afficher la carte recto -->
          {% if img.carte_recto %}
          <img src="{{ img.carte_recto.url }}" alt="Carte Recto" class="card-img-top">
          {% endif %}

          <!-- Afficher la carte verso -->
          {% if img.carte_verso %}
          <img src="{{ img.carte_verso.url }}" alt="Carte Verso avec QR" class="card-img-top mt-2">
          {% endif %}

          <div class="card-body">
            <h5 class="card-title" style="font-weight: bold;">{{ img.membre.nom}} {{ img.membre.prenom }}</h5>
            <p class="card-text">
              <strong>Département:</strong> {{img.membre.departement}}<br>
              <strong>Email:</strong> {{img.membre.email}}<br>
              <strong>Téléphone:</strong> {{img.membre.telephone}}
            </p>
          </div>

          <div class="card-footer">
            <small class="text-muted">Généré le: {{ img.date_generation|date:"d/m/Y H:i" }}</small>
            <div class="mt-2">
              <!-- Bouton télécharger PDF -->
              {% if img.carte_pdf %}
              <a href="{% url 'download_card' img.id %}" class="btn btn-success btn-sm">
                <i class="fas fa-download"></i> PDF
              </a>
              {% endif %}

              <!-- Bouton prévisualiser -->
              <a href="{% url 'preview_card' img.id %}" class="btn btn-info btn-sm">
                <i class="fas fa-eye"></i> Voir
              </a>

              <!-- Bouton régénérer -->
              <a href="{% url 'regenerate_card' img.membre.id %}" class="btn btn-warning btn-sm"
                onclick="return confirm('Voulez-vous régénérer cette carte?')">
                <i class="fas fa-redo"></i> Régénérer
              </a>
            </div>
          </div>
        </div>
      </div>

      {% endfor %}



    </div>
  </div>

  <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
</body>

</html>